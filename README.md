# Timeline - è¯­éŸ³é©±åŠ¨çš„æ—¥ç¨‹è®°å½•å·¥å…·

Timeline æ˜¯ä¸€ä¸ªè¯­éŸ³é©±åŠ¨çš„æ—¥ç¨‹è®°å½•å·¥å…·ï¼Œé€šè¿‡è¯­éŸ³è¾“å…¥è‡ªåŠ¨åˆ†æå¹¶åˆ›å»ºæ—¥å†æ¡ç›®ã€‚ä¸»è¦ç”¨äºè®°å½•ç”¨æˆ·æ¯å¤©åšçš„äº‹æƒ…ï¼Œé€šè¿‡è¯­éŸ³å¿«é€Ÿè®°å½•æ—¶é—´çº¿å’Œæ´»åŠ¨ã€‚

## åŠŸèƒ½ç‰¹æ€§

- ğŸ™ï¸ **è¯­éŸ³è½¬å½•**ï¼šæ”¯æŒä¸­è‹±æ–‡æ··åˆè¯­éŸ³è¯†åˆ«
- â° **æ—¶é—´æå–**ï¼šæ™ºèƒ½è¯†åˆ«æ—¶é—´æ®µå’Œç›¸å¯¹æ—¶é—´
- ğŸ“… **äº‹ä»¶æå–**ï¼šè‡ªåŠ¨æå–æ´»åŠ¨ã€åœ°ç‚¹ç­‰ä¿¡æ¯
- ğŸŒ **æ—¶åŒºæ”¯æŒ**ï¼šè‡ªåŠ¨å¤„ç†æ—¶åŒºè½¬æ¢
- ğŸš€ **å¿«é€Ÿéƒ¨ç½²**ï¼šæ”¯æŒä¸€é”®éƒ¨ç½²åˆ° ai-builders.space

## é¡¹ç›®ç»“æ„

```
timeline/
â”œâ”€â”€ app/
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ main.py              # FastAPI åº”ç”¨å…¥å£
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â””â”€â”€ routes.py        # API è·¯ç”±
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ transcription.py # éŸ³é¢‘è½¬å½•æœåŠ¡
â”‚   â”‚   â””â”€â”€ llm_extractor.py # LLM äº‹ä»¶æå–æœåŠ¡
â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”œâ”€â”€ __init__.py
â”‚   â”‚   â”œâ”€â”€ request.py       # è¯·æ±‚æ¨¡å‹
â”‚   â”‚   â””â”€â”€ response.py      # å“åº”æ¨¡å‹
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ __init__.py
â”‚       â”œâ”€â”€ timezone.py      # æ—¶åŒºå¤„ç†å·¥å…·
â”‚       â””â”€â”€ prompt_loader.py # Prompt æ¨¡æ¿åŠ è½½å™¨
â”œâ”€â”€ prompts/                 # LLM Prompt æ¨¡æ¿
â”‚   â””â”€â”€ prompts.md          # Prompt æ¨¡æ¿æ–‡ä»¶
â”œâ”€â”€ static/                  # é™æ€æ–‡ä»¶ï¼ˆæµ‹è¯•é¡µé¢ï¼‰
â”‚   â””â”€â”€ index.html          # æµ‹è¯•é¡µé¢
â”œâ”€â”€ tests/                   # æµ‹è¯•æ–‡ä»¶
â”‚   â”œâ”€â”€ __init__.py
â”‚   â””â”€â”€ test_api.py
â”œâ”€â”€ Dockerfile              # Docker é…ç½®
â”œâ”€â”€ requirements.txt        # Python ä¾èµ–
â””â”€â”€ README.md
```

## å¿«é€Ÿå¼€å§‹

### æœ¬åœ°å¼€å‘ï¼ˆæ¨èä½¿ç”¨ uvï¼‰

```bash
# 1. å®‰è£… uvï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
curl -LsSf https://astral.sh/uv/install.sh | sh
# æˆ–
pip install uv

# 2. åˆå§‹åŒ–é¡¹ç›®ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
uv venv

# 3. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source .venv/bin/activate  # Linux/Mac
# æˆ–
.venv\Scripts\activate  # Windows

# 4. å®‰è£…ä¾èµ–
uv pip install -r requirements.txt

# 5. è¿è¡ŒæœåŠ¡ï¼ˆå¼€å‘æ¨¡å¼ï¼Œæ”¯æŒçƒ­é‡è½½ï¼‰
uv run uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### ä½¿ç”¨ä¼ ç»Ÿæ–¹å¼

```bash
# 1. åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv

# 2. æ¿€æ´»è™šæ‹Ÿç¯å¢ƒ
source venv/bin/activate  # Linux/Mac
# æˆ–
venv\Scripts\activate  # Windows

# 3. å®‰è£…ä¾èµ–
pip install -r requirements.txt

# 4. è¿è¡ŒæœåŠ¡
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### ç¯å¢ƒå˜é‡è®¾ç½®

åˆ›å»º `.env` æ–‡ä»¶ï¼ˆä¸è¦æäº¤åˆ° Gitï¼‰ï¼š

```bash
AI_BUILDER_TOKEN=your_token_here
```

æˆ–ç›´æ¥è®¾ç½®ç¯å¢ƒå˜é‡ï¼š

```bash
export AI_BUILDER_TOKEN=your_token_here
```

## API æ–‡æ¡£

### POST /api/v1/analyze

åˆ†æéŸ³é¢‘æ–‡ä»¶ï¼Œæå–æ—¶é—´å’Œäº‹ä»¶ä¿¡æ¯ã€‚

**è¯·æ±‚æ ¼å¼**ï¼š
- Content-Type: `multipart/form-data`
- å‚æ•°ï¼š
  - `transcript`: è½¬å½•æ–‡æœ¬ï¼ˆå¿…éœ€ï¼‰
  - `current_time`: ISO 8601 æ ¼å¼çš„å½“å‰æ—¶é—´ï¼Œåº”åŒ…å«æ—¶åŒºä¿¡æ¯ï¼ˆå¿…éœ€ï¼Œå¦‚ `2024-01-15T14:30:00+08:00`ï¼‰
  - `tags`: å¯é€‰çš„æ ‡ç­¾åˆ—è¡¨ï¼ˆé€—å·åˆ†éš”ï¼‰

**å“åº”ç¤ºä¾‹**ï¼ˆæˆåŠŸï¼ŒHTTP 200ï¼‰ï¼š

```json
{
  "success": true,
  "events": [
    {
      "title": "ä¹°èœ",
      "start_time": "2024-01-15T14:00:00+08:00",
      "end_time": "2024-01-15T15:00:00+08:00",
      "description": "åœ°ç‚¹ï¼šè¶…å¸‚",
      "tag": "ç”Ÿæ´»"
    },
    {
      "title": "ç†å‘",
      "start_time": "2024-01-15T15:00:00+08:00",
      "end_time": "2024-01-15T15:30:00+08:00",
      "description": "åœ°ç‚¹ï¼šç†å‘åº—",
      "tag": "ç”Ÿæ´»"
    }
  ]
}
```

**å“åº”ç¤ºä¾‹**ï¼ˆé”™è¯¯ï¼ŒHTTP 4xx/5xxï¼‰ï¼š

```json
{
  "error": {
    "code": "TRANSCRIPTION_FAILED",
    "message": "è¯­éŸ³è¯†åˆ«å¤±è´¥ï¼Œè¯·é‡è¯•",
    "details": "æ— æ³•è¯†åˆ«éŸ³é¢‘æ ¼å¼"
  }
}
```

### GET /health

å¥åº·æ£€æŸ¥ç«¯ç‚¹ã€‚

**å“åº”**ï¼š

```json
{
  "status": "healthy"
}
```

### GET /

è¿”å› API ä¿¡æ¯ã€‚

## æŠ€æœ¯æ ˆ

- **FastAPI**: ç°ä»£ã€å¿«é€Ÿçš„ Web æ¡†æ¶
- **Uvicorn**: ASGI æœåŠ¡å™¨
- **httpx**: å¼‚æ­¥ HTTP å®¢æˆ·ç«¯
- **pytz**: æ—¶åŒºå¤„ç†
- **python-dateutil**: æ—¶é—´è§£æ
- **Pydantic**: æ•°æ®éªŒè¯

## éƒ¨ç½²

### éƒ¨ç½²åˆ° ai-builders.space

1. ç¡®ä¿ä»£ç å·²æ¨é€åˆ° GitHub å…¬å¼€ä»“åº“
2. ç¡®ä¿ Dockerfile å’Œ requirements.txt å·²åˆ›å»º
3. è°ƒç”¨éƒ¨ç½² APIï¼ˆå‚è€ƒ `docs/deployment-prompt.md`ï¼‰

### Docker æ„å»º

```bash
docker build -t timeline .
docker run -p 8000:8000 -e AI_BUILDER_TOKEN=your_token timeline
```

## ä½¿ç”¨åœºæ™¯

### Web åº”ç”¨

Timeline ä¸»è¦ä½œä¸º Web åº”ç”¨ä½¿ç”¨ï¼š

1. åœ¨æµè§ˆå™¨ä¸­å½•éŸ³
2. ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶åˆ° Timeline API
3. æ¥æ”¶ JSON æ ¼å¼çš„äº‹ä»¶åˆ—è¡¨
4. åœ¨ç½‘é¡µä¸­æŸ¥çœ‹å’Œå¯¼å‡ºåˆ°æ—¥å†ï¼ˆApple Calendar æˆ– Google Calendarï¼‰

**Web å·¥ä½œæµç¨‹**ï¼š

```
1. è®¿é—® Web é¡µé¢
   â†“
2. ç‚¹å‡»å½•éŸ³æŒ‰é’®å¼€å§‹å½•éŸ³
   â†“
3. åœæ­¢å½•éŸ³ï¼Œè‡ªåŠ¨ä¸Šä¼ éŸ³é¢‘æ–‡ä»¶
   â†“
4. æ¥æ”¶åˆ†æç»“æœï¼ˆè½¬å½•æ–‡æœ¬å’Œäº‹ä»¶åˆ—è¡¨ï¼‰
   â†“
5. æŸ¥çœ‹äº‹ä»¶åˆ—è¡¨
   â†“
6. å¯¼å‡ºåˆ°æ—¥å†ï¼ˆApple Calendar æˆ– Google Calendarï¼‰
```

## å¼€å‘è¯´æ˜

### LLM äº‹ä»¶æå–

æœ¬é¡¹ç›®ä½¿ç”¨ LLMï¼ˆé€šè¿‡ AI Builder Space APIï¼‰è¿›è¡Œæ—¶é—´è§£æå’Œäº‹ä»¶æå–ï¼Œè€Œä¸æ˜¯ä¼ ç»Ÿçš„ NLP è§„åˆ™ã€‚è¿™æä¾›äº†æ›´å¥½çš„çµæ´»æ€§å’Œå‡†ç¡®æ€§ã€‚

**ä½¿ç”¨çš„æ¨¡å‹**ï¼š`gemini-3-flash-preview`ï¼ˆå¿«é€Ÿæ¨ç†ï¼Œé€‚åˆæ—¶é—´è§£æä»»åŠ¡ï¼‰

**Prompt è®¾è®¡**ï¼šå‚è€ƒ [TimeFlow](https://github.com/lindapu-1/TimeFlow) é¡¹ç›®çš„è®¾è®¡ç†å¿µã€‚

### æ—¶åŒºå¤„ç†

- æ—¶åŒºä¿¡æ¯ä» ISO 8601 æ ¼å¼çš„ `current_time` å‚æ•°ä¸­è‡ªåŠ¨æå–
- æ”¯æŒæ—¶åŒºåç§»é‡ï¼ˆå¦‚ `+08:00`ã€`-05:00`ï¼‰
- æ”¯æŒ UTC æŒ‡ç¤ºç¬¦ï¼ˆ`Z`ï¼‰
- å¦‚æœæ²¡æœ‰æ—¶åŒºä¿¡æ¯ï¼Œé»˜è®¤ä½¿ç”¨ UTC
- è‡ªåŠ¨å¤„ç†æ—¶åŒºè½¬æ¢

### é”™è¯¯å¤„ç†

- HTTP 400ï¼šè¯·æ±‚æ ¼å¼é”™è¯¯
- HTTP 422ï¼šå¤„ç†å¤±è´¥ï¼ˆæ— æ³•è¯†åˆ«æ—¶é—´ã€æ— æ³•æå–äº‹ä»¶ï¼‰
- HTTP 500ï¼šæœåŠ¡å™¨é”™è¯¯

## è®¸å¯è¯

MIT License

## å‚è€ƒèµ„æº

- [TimeFlow é¡¹ç›®](https://github.com/lindapu-1/TimeFlow)ï¼šå‚è€ƒå…¶ Prompt è®¾è®¡å’Œå®ç°æ€è·¯
- [TimeFlow prompts.md](https://github.com/lindapu-1/TimeFlow/blob/main/prompts.md)ï¼šè¯¦ç»†çš„ Prompt æ¨¡æ¿è®¾è®¡
